<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: frontend/src/components/Map.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: frontend/src/components/Map.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview * React component to handle routing between waypoints on a Leaflet map.
 */
import React, { useEffect, useRef } from 'react';
import { MapContainer, TileLayer, useMap } from 'react-leaflet';
import 'leaflet/dist/leaflet.css';
import L from 'leaflet';
import 'leaflet-routing-machine';
import 'leaflet-routing-machine/dist/leaflet-routing-machine.css';

delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
  iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',
  iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',
  shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
});

// Routing component with smooth updates
const Routing = ({ waypoints }) => {
  const map = useMap();
  const routingControlRef = useRef(null);

  useEffect(() => {
    if (!map || !waypoints || waypoints.length &lt; 2) return;

    const leafletWaypoints = waypoints.map(
      (wp) => L.latLng(wp.coordinates.lat, wp.coordinates.lng)
    );

    // Create routing control only once
    if (!routingControlRef.current) {
      routingControlRef.current = L.Routing.control({
        waypoints: leafletWaypoints,
        routeWhileDragging: false,
        draggableWaypoints: false,
        addWaypoints: false,
        fitSelectedRoutes: true,
        showAlternatives: false,
        lineOptions: { styles: [{ color: '#6FA1EC', weight: 4 }] }
      }).addTo(map);
    } else {
      // Animate waypoint update
      const currentWaypoints = routingControlRef.current.getWaypoints();

      // Gradually update waypoints to new positions
      leafletWaypoints.forEach((newWp, i) => {
        if (
          !currentWaypoints[i] ||
          currentWaypoints[i].latLng.lat !== newWp.lat ||
          currentWaypoints[i].latLng.lng !== newWp.lng
        ) {
          currentWaypoints[i] = { ...currentWaypoints[i], latLng: newWp };
        }
      });

      routingControlRef.current.setWaypoints(currentWaypoints);
    }

    // Cleanup on unmount
    return () => {
      if (routingControlRef.current) {
        try {
          map.removeControl(routingControlRef.current);
        } catch (err) {
          console.warn('Routing control removal failed:', err);
        }
        routingControlRef.current = null;
      }
    };
  }, [map, waypoints]);

  return null;
};

// Main Map component
const Map = ({ waypoints }) => (
  &lt;MapContainer
    center={[20.5937, 78.9629]}
    zoom={5}
    style={{ height: '100%', width: '100%', borderRadius: '8px' }}
  >
    &lt;TileLayer
      url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
      attribution='&amp;copy; &lt;a href="https://www.openstreetmap.org/copyright">OpenStreetMap&lt;/a>'
    />
    {waypoints &amp;&amp; waypoints.length >= 2 &amp;&amp; &lt;Routing waypoints={waypoints} />}
  &lt;/MapContainer>
);

export default Map;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#HomePage">HomePage</a></li><li><a href="global.html#UserLandingPage">UserLandingPage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Mon Sep 29 2025 12:52:50 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
